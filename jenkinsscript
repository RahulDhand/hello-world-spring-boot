pipeline {
   agent any
   stages{
       stage('Build'){

        steps{

         
               sh '''

                docker build -t manojsinghmanoj/helloworld:v24 .

                '''

          

        }

    }
   

    stage('Publish'){

        steps{

            withCredentials([string(credentialsId: 'dockerhub', variable: 'DOCKER_PASSWD')])

            {

            sh '''

            echo $DOCKER_PASSWD  
            
            docker login --username 'manojsinghmanoj' --password-stdin ${DOCKER_PASSWD} 

            docker push docker.io/manojsinghmanoj/helloworld:v24

            docker logout

            '''

            }

        }

    }
   }

}
